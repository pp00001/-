*** Settings ***
Resource          res_interface.txt

*** Test Cases ***
发起请求
    ${url}    Set Variable    http://10.0.4.147:8080/dubbo-rest/dubbo/send
    ${dict}=    Create Dictionary    topic=MQ_TOPIC_KAFKA_PROFILE_SYSTEM    message = {"collectTime":1527151986665,"bizType":"shareQuery","data":{"msg":"请求成功","phone_no":"13000000008","request":{"idType":"101","idCard":"110000000000000015","name":"高华岭","queryReason":"10"},"code":"200","response":{"errorCode":"0000","message":"查询成功","params":{"tx":"102","data":{"loanRecords":[{"overdueAmount":"(0,1000]","orgName":"427","overdueTotal":"2","overdueM6":"3","loanStatusCode":"4","approvalStatusCode":"203","overdueM3":"5","loanAmount":"(0,1000]","loanTypeCode":"21","certNo":"110000000000000015","name":"高华岭","loanDate":"201705","periods":"1","overdueStatus":"1"},{"overdueAmount":"(5000,10000]","orgName":"64","overdueTotal":"22","overdueM6":"33","loanStatusCode":"44","approvalStatusCode":"203","overdueM3":"55","loanAmount":"(5000,10000]","loanTypeCode":"21","certNo":"110000000000000015","name":"高华岭","loanDate":"201705","periods":"6","overdueStatus":"11"},{"overdueAmount":"(5000,10000]","orgName":"64","overdueTotal":"222","overdueM6":"333","loanStatusCode":"444","approvalStatusCode":"204","overdueM3":"555","loanAmount":"(5000,10000]","loanTypeCode":"21","certNo":"110000000000000015","name":"高华岭","loanDate":"201805","periods":"6","overdueStatus":"111"},{"overdueAmount":"(0,1000]","orgName":"284","overdueTotal":"2222","overdueM6":"3333","loanStatusCode":"4444","approvalStatusCode":"203","overdueM3":"5555","loanAmount":"(0,1000]","loanTypeCode":"22","certNo":"110000000000000015","name":"高华岭","loanDate":"201612","periods":"1","overdueStatus":"1111"},{"overdueAmount":"(0,1000]","orgName":"465","overdueTotal":"22222","overdueM6":"33333","loanStatusCode":"44444","approvalStatusCode":"203","overdueM3":"55555","loanAmount":"(0,1000]","loanTypeCode":"21","certNo":"110000000000000015","name":"高华岭","loanDate":"201708","periods":"1","overdueStatus":"11111"},{"overdueAmount":"(0,1000]","orgName":"185","overdueTotal":"222222","overdueM6":"333333","loanStatusCode":"444444","approvalStatusCode":"203","overdueM3":"555555","loanAmount":"(0,1000]","loanTypeCode":"23","certNo":"110000000000000015","name":"高华岭","loanDate":"201707","periods":"1","overdueStatus":"111111"},{"overdueAmount":"(100, 1000]","orgName":"185","overdueTotal":"2222222","overdueM6":"3333333","loanStatusCode":"4444444","approvalStatusCode":"203","overdueM3":"5555555","loanAmount":"(0, 1000]","loanTypeCode":"23","certNo":"110000000000000015","name":"高华岭","loanDate":"201805","periods":"1","overdueStatus":"1111111"},{"overdueAmount":"(1000, 5000]","orgName":"185","overdueTotal":"22222222","overdueM6":"33333333","loanStatusCode":"44444444","approvalStatusCode":"203","overdueM3":"55555555","loanAmount":"(1000, 5000]","loanTypeCode":"23","certNo":"110000000000000015","name":"高华岭","loanDate":"201805","periods":"1","overdueStatus":"11111111"},{"overdueAmount":"(100,1000]","orgName":"427","overdueTotal":"99","overdueM6":"999","loanStatusCode":"302","approvalStatusCode":"302","overdueM3":"99999","loanAmount":"(100,1000]","loanTypeCode":"21","certNo":"110000000000000015","name":"高华岭","loanDate":"201704","periods":"1","overdueStatus":"11111111"},{"overdueAmount":"(100,1000]","orgName":"427","overdueTotal":"1010","overdueM6":"101010","loanStatusCode":"302","approvalStatusCode":"203","overdueM3":"1010101010","loanAmount":"(100,1000]","loanTypeCode":"21","certNo":"110000000000000015","name":"高华岭","loanDate":"201703","periods":"1","overdueStatus":"111111111"},{"overdueAmount":"(0,1000]","orgName":"427","overdueTotal":"111","overdueM6":"111","loanStatusCode":"11111","approvalStatusCode":"203","overdueM3":"111111","loanAmount":"(0,1000]","loanTypeCode":"21","certNo":"110000000000000015","name":"高华岭","loanDate":"201702","periods":"1","overdueStatus":"12331313"}],"queryStatistics":{"timesByOtherOrg":5,"timesByCurrentOrg":0,"otherOrgCount":5},"riskResults":[{"riskItemValue":"430224198902203316","sourceCode":"10","riskTime":"2018","riskTypeCode":"12","riskType":"资料虚假类","riskItemType":"证件号码","riskItemTypeCode":"101010","source":"宜信个人客户"},{"riskItemValue":"430224198902203316","sourceCode":"10","riskTime":"2018","riskTypeCode":"11","riskType":"资料虚假类","riskItemType":"证件号码","riskItemTypeCode":"101010","source":"宜信个人客户"},{"riskItemValue":"430224198902203316","sourceCode":"10","riskTime":"2016","riskTypeCode":"12","riskType":"资料虚假类","riskItemType":"证件号码","riskItemTypeCode":"101010","source":"宜信个人客户"},{"riskItemValue":"430224198902203316","sourceCode":"10","riskTime":"2016","riskTypeCode":"10","riskType":"资料虚假类","riskItemType":"证件号码","riskItemTypeCode":"101010","source":"宜信个人客户"},{"riskItemValue":"430224198902203316","sourceCode":"10","riskTime":"2017","riskTypeCode":"10","riskType":"资料虚假类","riskItemType":"证件号码","riskItemTypeCode":"101010","source":"宜信个人客户"},{"riskItemValue":"13186666176","sourceCode":"10","riskTime":"2018","riskTypeCode":"10","riskType":"资料虚假类","riskItemType":"手机号码","riskItemTypeCode":"102010","source":"宜信个人客户"}],"contractBreakRate":"14.86%","queryHistory":[{"orgType":"其他机构","orgName":"86","queryReason":"12","time":"2018-05-08"},{"orgType":"其他机构","orgName":"384","queryReason":"12","time":"2018-05-06"},{"orgType":"其他机构","orgName":"98","queryReason":"12","time":"2018-04-14"},{"orgType":"其他机构","orgName":"465","queryReason":"10","time":"2018-05-23"},{"orgType":"其他机构","orgName":"185","queryReason":"10","time":"2018-04-23"},{"orgType":"其他机构","orgName":"385","queryReason":"10","time":"2018-03-23"},{"orgType":"非持牌消金-小额现金贷","orgName":"285","queryReason":"10","time":"2018-02-23"},{"orgType":"非持牌消金-小额现金贷","orgName":"485","queryReason":"10","time":"2017-11-23"},{"orgType":"非持牌消金-小额现金贷","orgName":"585","queryReason":"12","time":"2017-11-23"},{"orgType":"非持牌消金-小额现金贷","orgName":"585","queryReason":"12","time":"2016-11-23"},{"orgType":"非持牌消金-小额现金贷","orgName":"585","queryReason":"12","time":"2016-11-23"}],"zcCreditScore":"536","flowId":"a9d257c215354a94b9b34516e66c0550"}}},"id_card":"110000000000000015","flowNo":"7bdb8782e87e43ccb959984e18be65be"},"dataType":"YiXin","timeline":{"timeToProfileEngine":1527151986665,"timeApiCallSend":1527151984891,"timeDataCloudReceive":1527151984953},"eventType":"verify","sessionId":"7bdb8782e87e43ccb959984e18be65be","dataSource":"001","productType":"fast_loan"}
    ${heads}    Create Dictionary    Content-Type=application/json
    ${resp}    requests.Post    ${url}    ${dict}    ${heads}
    log    ---------------------------------------------------------------接口请求成功：${resp.content}--------------------------------------------------
    log    ${empty}
    log    ${empty}

验证dubbo接口变量数据
    ${reponse}    获取变量名list    ${variable_txt['parms']}
    log    ${reponse}
    ${length}    Get Length    ${reponse}
    log    ${length}
    : FOR    ${j}    IN RANGE    ${length}
    \    ${Assemble}    组装变量得到预期结果    parms    ${j}    ${reponse[${j}]}
    \    log    ${Assemble}
    \    ${Assemble1}    dubbo获取所有变量得到实际结果    ${reponse[${j}]}
    \    log    ---------------------------------------------正在校验第“${j}”变量结果---------------------------
    \    log    ${Assemble1}
    \    Should Be Equal    ${Assemble1}    ${Assemble}    message=变量结果不一致
    \    log    ---------------------------------------------变量：${reponse[${j}]}---》校验完成且正确--------------------------------------------------
    log    --------------------------------------------------------------------------------------------------------------宜信变量接口：合计“${length}”个已全部测试完毕-----------------------------------------------------------------------------------------------------------------------------------------------------------------

*** Keywords ***
